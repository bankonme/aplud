{"name":"Aplud","tagline":"Automatic Persistent Live USB (Debian)","body":"aplud\r\n=====\r\n\r\n***Automatic Persistent Live USB (Debian)***\r\n\r\nUsage\r\n-----\r\n\r\n\t$ wget -c http://live.debian.net/cdimage[...]debian-live-[...].iso\r\n\t# whereis/aplud debian-live.iso /dev/sdX\r\n\r\n\r\nRequires\r\n--------\r\n\r\n* 7z \r\n* syslinux\r\n* mkfs.vfat\r\n* mkfs.ext4\r\n* mbr\r\n* fdisk\r\n\r\nDebian distro : \r\n\r\n\tapt-get install 7zip-full syslinux dosfstools mbr util-linux\r\n\r\n```dosfstools``` is also known as ```mtools```\r\n\t\r\nAbout\r\n-----\r\n\r\nThis creates a live USB drive with:\r\n\r\n* debian (by default, full persistence) \r\n* grml (you want ```grml2usb```, full persistence)\r\n* ubuntu (full persistence, *painfully slow*)\r\n* mint (full persistence)\r\n* slitaz4 (home persistence only).\r\n* Any ISOLINUX based Live-CD (See 'Using Plugins' for limitations), it will then create an extra partition using the free space left on the device. No persistence. It has been added for convenience, it works very often, but may not. \r\n \r\nIt's similar to unetbootin, usb-creator etc., but it's minimalist and base code is less\r\nintimidating - it's just a shell script.\r\n\r\nIt will use the size of the isofile + 10% for the livesystem partition, the\r\nrest of the pendrive storage being used for persistence/data as an ext4 filesystem.\r\n\r\nIt works with a plugin system, so you can create a definition for other distros.\r\n\r\nThe included plugins will try to set up the language and keyboard, so you should\r\nnot have to be worried about this (it uses $LANG environment variable).\r\n\r\n### Performance ###\r\n\r\nPlease note that persistent live usb is slower than a standard live usb.\r\n\r\nGetting the good device\r\n-----------------------\r\n\r\n* Plug your usb pendrive in your computer\r\n* Run\r\n\r\n\t\t$ dmesg | tail\r\n\t\t[...]\r\n\t\t[ 5717.903243] sd 6:0:0:0: [sdb] Attached SCSI removable disk\r\n\t\t[...]\r\n\r\n* Here the device is ```/dev/sdb```\r\n\r\n\r\nRuntime Problems\r\n----------------\r\n\r\n* fdisk fails with 'device is busy' : Aplud tries hard to circumvent\r\n  automounter programs. Anyway you should wait some seconds after plugging your\r\n  USB pendrive, then launch aplud. Also be sure no program is in a device\r\n  mountpoint\r\n\r\n* The resulting USB pendrive may be stuck with \"MBR\" message. Retry aplud on it. \r\n\r\n* If you have no mkfs.* programs on your system, modify global.conf accordingly.\r\n\r\nUsing Plugins\r\n-------------\r\n\r\nAdd the distro name as the third argument of aplud. To get the list of all \r\nsupported distros, type \r\n\r\n\t$ ./aplud\r\n\r\n### Using unsupported distros ###\r\n\r\nUse simply 'generic' as distro name. It's not granted it will work, the ```isolinux```\r\ndirectory must be in the ```boot``` directory of the ISO.\r\n\r\nCreating Plugins\r\n----------------\r\n\r\n### How alupd works ###\r\n\r\nYou need to know that before creating a plugin. In a nutshell it acts like this : \r\n\r\n1. Partition the drive\r\n2. Create filesystems\r\n3. Extract the iso in the live filesystem\r\n4. Convert ISOLINUX to SYSLINUX *It's where plugin matters*\r\n   1. It needs to modify syslinux.cfg (or whatever .cfg file used by the target distro)\r\n     to add keyboard/language/whatever needed (```persistence``` keyword is needed\r\n     for Debian for example).\r\n\r\n### What you need ###\r\n\r\nFor this you'll need to extract the iso and find the isolinux folder :\r\n   \r\n\t$ mkdir /tmp/iso \r\n\t$ cd /tmp/iso\r\n\t$ 7z x file.iso\r\n\t$ find . -type d -name isolinux \r\n\t./boot/isolinux\r\n\r\nNote that the syslinux prefix will be ```\"boot/\"```. Never use a leading '/' !\r\nIf ```isolinux/``` is in the current directory, the syslinux prefix should be\r\n\"\"\r\n\r\nNow read the cfg files to find the boot entries in this isolinux folder, and\r\ncatch a common string among them. Most often it's simply ```isolinux.cfg```,\r\nthen try this: \r\n\r\n\t$ sed 's/\\(that common string\\)/\\1 myparam/g' file.cfg \r\n\r\nto test.\r\n\r\n* ```that common string``` will be in the plugin file the value of the variable ```appentrigger```\r\n* ```myparam``` will be in the plugin file the value of the variable ```bootappend```\r\n* ```file.cfg``` will be in the plugin file the value of the variable ```syslinuxcfg``` If the file is ```isolinux.cfg``` then use ```syslinux.cfg``` instead\r\n\r\nYou'll need to know the boot options of the live cd you wan to use as well.\r\n\r\n### Actual plugin creation ###\r\n     \r\nLet's say you want to add the 'newdistro' distribution : \r\n\r\n\t$ cd whereisaplud/conf \r\n\t$ cp grml.conf newdistro.conf\r\n\t$ vi newdistro.conf\r\n\r\nIt's documented by itself, and if you've the values found just before, it should work:\r\n\r\n\t$ cd whereisaplud\r\n\t# ./aplud newdistro-i686-20141210.iso /dev/sdX newdistro\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}